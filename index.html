<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VaxMandate Decision Aid Tool</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-papNMzNnQn5iH+1G+FHu8SyuXHs6A1k+Ln7tK5qRo1l5eYm6Jzv+1pArJ7N4C9FfpRrmAgM3tYWd3FZ9jKz1Bw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Chart.js Library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- jsPDF Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>VaxMandate Decision Aid Tool</h1>
      <p>
        This tool helps evaluate vaccine mandate policies in terms of public uptake and cost–benefit outcomes. Configure a mandate’s scope, exemptions, coverage threshold, and expected lives saved to see predicted compliance and net benefits across different countries and outbreak scenarios.
      </p>
    </header>

    <nav class="tabs" role="tablist">
      <button class="tablink active" data-tab="introTab" aria-selected="true">
        <i class="fa-solid fa-info-circle"></i><span> Introduction</span>
      </button>
      <button class="tablink" data-tab="instructionsTab" aria-selected="false">
        <i class="fa-solid fa-circle-question"></i><span> Instructions</span>
      </button>
      <button class="tablink" data-tab="attributesTab" aria-selected="false">
        <i class="fa-solid fa-list"></i><span> Attributes</span>
      </button>
      <button class="tablink" data-tab="inputsTab" aria-selected="false">
        <i class="fa-solid fa-sliders"></i><span> Inputs</span>
      </button>
      <button class="tablink" data-tab="wtpTab" aria-selected="false">
        <i class="fa-solid fa-chart-bar"></i><span> WTS Results</span>
      </button>
      <button class="tablink" data-tab="probTab" aria-selected="false">
        <i class="fa-solid fa-chart-pie"></i><span> Predicted Uptake</span>
      </button>
      <button class="tablink" data-tab="costsTab" aria-selected="false">
        <i class="fa-solid fa-calculator"></i><span> Costs &amp; Benefits</span>
      </button>
      <button class="tablink" data-tab="scenariosTab" aria-selected="false">
        <i class="fa-solid fa-folder-open"></i><span> Saved Scenarios</span>
      </button>
         <button class="tablink" data-tab="demoTab" aria-selected="false">
     <i class="fa-solid fa-video"></i><span> Video Demo</span>
   </button>
    </nav>

    <!-- Introduction Tab -->
    <section id="introTab" class="tabcontent" tabindex="0" style="display: block;">
      <div class="intro-box">
        <p>
          Vaccine mandates can increase vaccination rates and save lives, but involve trade-offs in who is covered and what exemptions are allowed. This tool uses DCE-based estimates from Australia, France, and Italy to predict mandate uptake (support vs. opt-out) and perform cost–benefit analysis. Adjust the parameters to explore how different designs perform under <em>mild outbreak</em> vs. <em>severe outbreak</em> scenarios.
        </p>
        <ul>
          <li><strong>Instructions</strong> – How to use the simulator step by step.</li>
          <li><strong>Attributes</strong> – Details of mandate features (hover over info icons for descriptions and reference levels).</li>
          <li><strong>Inputs</strong> – Select country, outbreak scenario, and configure your mandate scenario.</li>
          <li><strong>WTS Results</strong> – View charts of willingness-to-save-lives for each attribute (lives trade-off values from the DCE).</li>
          <li><strong>Predicted Uptake</strong> – See predicted public uptake percentage and get recommendations based on results.</li>
          <li><strong>Costs &amp; Benefits</strong> – Analyse the costs, QALY-based benefits, and net benefit with breakdowns.</li>
          <li><strong>Saved Scenarios</strong> – Compare multiple scenarios side by side or export results to PDF.</li>
        </ul>
      </div>
    </section>

    <!-- Instructions Tab -->
    <section id="instructionsTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>How to Use This Tool</h4>
        <ol>
          <li style="margin-left: 20px;">Go to the <strong>Attributes</strong> tab to understand each policy feature. Hover over the <i class="fa-solid fa-info-circle"></i> icons for additional details and to see the reference (default) levels.</li>
          <li style="margin-left: 20px;">In the <strong>Inputs</strong> tab, first choose a <strong>Country</strong> and an <strong>Outbreak Scenario</strong> (e.g. pooled data, mild outbreak, or severe outbreak). These selections determine which preference estimates will be used.</li>
          <li style="margin-left: 20px;">Configure the mandate’s features using the provided options:
            <ul>
              <li><em>Scope:</em> High-risk occupations only (reference) or All occupations &amp; public spaces.</li>
              <li><em>Exemption policy:</em> Medical only (reference), Medical + religious, or Broad (including personal beliefs).</li>
              <li><em>Coverage requirement:</em> 50% (reference), 70%, or 90% vaccinated before lifting the mandate.</li>
              <li><em>Estimated lives saved:</em> Use the slider to set how many lives (per 100,000 people) the mandate is expected to save.</li>
            </ul>
            You may leave an option unselected to use its reference level by default.
          </li>
          <li style="margin-left: 20px;">Click “<strong>Calculate &amp; View Results</strong>”. This will display the predicted uptake percentage and a brief recommendation based on your scenario.</li>
          <li style="margin-left: 20px;">Navigate to the <strong>WTS Results</strong> tab to see a chart of how many lives need to be saved (per 100k) for each attribute to be acceptable (the WTS values). These are derived from respondents’ trade-offs in the DCE.</li>
          <li style="margin-left: 20px;">Check the <strong>Predicted Uptake</strong> tab for a chart of uptake vs. non-uptake.</li>
          <li style="margin-left: 20px;">In the <strong>Costs &amp; Benefits</strong> tab, review the economic analysis. Select a QALY gain scenario (low/moderate/high) to vary how many quality-adjusted life years each saved life represents. The summary will update with total costs, monetised benefits, and net benefit. Click “Cost Breakdown” or “Benefits Analysis” for detailed components and assumptions.</li>
          <li style="margin-left: 20px;">Use <strong>Saved Scenarios</strong> to save your current inputs and results. You can save multiple scenarios (they will appear in the table), then click “Compare &amp; Export to PDF” to generate a side-by-side comparison report.</li>
        </ol>
      </div>
    </section>

    <!-- Attributes Tab -->
    <section id="attributesTab" class="tabcontent" tabindex="0">
      <h2>Mandate Attributes</h2>
      <div class="attributes-list">
        <!-- Attribute Card: Scope of Mandate -->
        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <svg width="24" height="24" fill="#2980b9" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="#2980b9" stroke-width="2" fill="none"/>
              <path d="M10 15l-3-3 1.4-1.4 1.6 1.6L15 7l1.4 1.4-6.4 6.4z" fill="#2980b9"/>
            </svg>
            <div class="tooltip" role="tooltip">
              <strong>Reference: High-risk only</strong><br/>
              Who must get vaccinated. High-risk occupations (e.g. healthcare, emergency services) are mandated by default. Alternatively, <em>All occupations &amp; public venues</em> means everyone working in or entering public settings must be vaccinated.
            </div>
          </div>
          <div class="attribute-content">
            <h4>Scope of the Mandate</h4>
            <p>High-risk jobs only vs. all workers &amp; public spaces.</p>
          </div>
        </div>
        <!-- Attribute Card: Exemption Policy -->
        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <svg width="24" height="24" fill="#e67e22" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="#e67e22" stroke-width="2" fill="none"/>
              <path d="M12 4a8 8 0 0 1 0 16 8 8 0 0 1 0-16z" fill="#e67e22"/>
            </svg>
            <div class="tooltip" role="tooltip">
              <strong>Reference: Medical only</strong><br/>
              Grounds for opting out. The strictest policy allows only doctor-certified medical exemptions. More lenient options include <em>medical + religious</em> exemptions, or <em>broad exemptions</em> (adding personal or philosophical objections).
            </div>
          </div>
          <div class="attribute-content">
            <h4>Exemption Policy</h4>
            <p>Who can opt out: just medical, or also religious/personal reasons.</p>
          </div>
        </div>
        <!-- Attribute Card: Coverage Requirement -->
        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <svg width="24" height="24" fill="#27ae60" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="#27ae60" stroke-width="2" fill="none"/>
              <path d="M12 6v6l4 2" stroke="#27ae60" stroke-width="2" fill="none"/>
            </svg>
            <div class="tooltip" role="tooltip">
              <strong>Reference: 50% coverage</strong><br/>
              The vaccination rate needed to lift the mandate. At <em>50%</em> (low threshold), mandates end sooner; at <em>70%</em> most restrictions can lift with precautions; at <em>90%</em> (high threshold), mandates stay until nearly everyone is vaccinated, ensuring maximum protection.
            </div>
          </div>
          <div class="attribute-content">
            <h4>Coverage Requirement</h4>
            <p>Vaccination rate (50%, 70%, 90%) to remove mandates.</p>
          </div>
        </div>
        <!-- Attribute Card: Lives Saved -->
        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <svg width="24" height="24" fill="#8e44ad" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="#8e44ad" stroke-width="2" fill="none"/>
              <path d="M8 12h8M12 8v8" stroke="#8e44ad" stroke-width="2" fill="none"/>
            </svg>
            <div class="tooltip" role="tooltip">
              The estimated number of lives saved (per 100,000 people) due to the mandate’s increased vaccination. For example, saving 40 lives per 100k means significantly reducing deaths by curbing the virus spread through the mandate.
            </div>
          </div>
          <div class="attribute-content">
            <h4>Lives Saved</h4>
            <p>Lives saved per 100k population due to the mandate.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Inputs Tab -->
    <section id="inputsTab" class="tabcontent" tabindex="0">
      <div class="input-card">
        <h2>Configure Mandate Scenario</h2>
        <p>Choose a country and outbreak context, then select policy levels for each feature. Unselected features default to the reference level.</p>
        <form onsubmit="event.preventDefault();">
          <div class="input-cards">
            <!-- Context Card: Country & Scenario -->
            <div class="input-level-card">
              <h3>Context Selection</h3>
              <div class="options">
                <label>
                  Country:
                  <select id="country_select">
                    <option value="Australia">Australia</option>
                    <option value="France">France</option>
                    <option value="Italy">Italy</option>
                  </select>
                </label>
                <label style="margin-top: 5px;">
                  Outbreak Scenario:
                  <select id="framing_select">
                    <option value="pooled">All Outbreaks (Pooled Data)</option>
                    <option value="mild">Mild Outbreak</option>
                    <option value="severe">Severe Outbreak</option>
                  </select>
                </label>
              </div>
            </div>
            <!-- Scope Card -->
            <div class="input-level-card">
              <h3>Scope <span class="reference">(Reference: High-risk only)</span></h3>
              <div class="options">
                <label>
                  <input type="radio" name="scope" id="allScopeCheck" value="all" />
                  All occupations &amp; public spaces
                </label>
                <!-- If not selected, default is high-risk only -->
              </div>
            </div>
            <!-- Exemption Card -->
            <div class="input-level-card">
              <h3>Exemptions <span class="reference">(Reference: Medical only)</span></h3>
              <div class="options">
                <label>
                  <input type="radio" name="exemption" id="medRelCheck" value="medRel" />
                  Medical + religious
                </label>
                <label>
                  <input type="radio" name="exemption" id="broadCheck" value="broad" />
                  Broad (medical, religious, personal)
                </label>
              </div>
            </div>
            <!-- Coverage Card -->
            <div class="input-level-card">
              <h3>Coverage Target <span class="reference">(Reference: 50%)</span></h3>
              <div class="options">
                <label>
                  <input type="radio" name="coverage" id="cov70Check" value="70" />
                  70% vaccinated
                </label>
                <label>
                  <input type="radio" name="coverage" id="cov90Check" value="90" />
                  90% vaccinated
                </label>
              </div>
            </div>
            <!-- Lives Saved Slider Card -->
            <div class="input-level-card">
              <h3>Estimated Lives Saved (per 100k)</h3>
              <div class="options slider-option">
                <label for="livesSlider">
                  <i class="fa-solid fa-heart"></i>
                  <span id="livesLabel">25</span>
                </label>
                <input type="range" id="livesSlider" min="0" max="50" step="1" value="25" oninput="updateLivesDisplay(this.value)" />
              </div>
            </div>
          </div>
          <div class="buttons-row">
            <button type="button" onclick="openSingleScenario()">Calculate &amp; View Results</button>
          </div>
        </form>
        <!-- Modal Popup for Results -->
        <div id="resultModal" class="modal">
          <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            <div id="modalResults"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- WTS Results Tab -->
    <section id="wtpTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Willingness-to-Save-Lives (WTS) Results</h4>
        <p>
          The WTS value for each attribute is the trade-off in lives saved (per 100k people) that makes the policy change acceptable, calculated as the ratio of that attribute’s coefficient to the “lives saved” coefficient in the DCE. In other words, it’s how many additional lives would need to be saved to offset the negative impact of that attribute (if WTS is positive), or how many lives the public is willing to forego for a desirable attribute (if WTS is negative). Higher WTS indicates a stronger public aversion to that feature.
        </p>
        <p>
          For example, if “All occupations” has WTS = 4, the mandate must save ~4 more lives per 100k for people to accept expanding from high-risk workers to everyone. Negative WTS (e.g., for a higher coverage target) means people prefer that feature (they would sacrifice some lives saved to have it). The chart below shows WTS (with standard errors) for the selected country and scenario.
        </p>
        <div class="buttons-row">
          <button onclick="renderWTPChart()">Show WTS Charts</button>
        </div>
        <div class="chart-grid">
          <div class="chart-box">
            <h3>WTS (Lives per 100k)</h3>
            <canvas id="wtpChartMain"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Predicted Uptake Tab -->
    <section id="probTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Predicted Mandate Uptake</h4>
        <p>
          Click “Show Probability Plot” to visualize the predicted share of the population that would support/comply with the mandate versus opt out. This percentage is based on the DCE preference model and your selected scenario inputs.
        </p>
        <div class="buttons-row">
          <button onclick="renderProbChart()">Show Probability Plot</button>
        </div>
        <div class="chart-grid">
          <div class="chart-box" style="position: relative; height:300px;">
            <h3>Uptake vs. Non‑uptake</h3>
            <canvas id="uptakeChart"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Costs & Benefits Tab -->
    <section id="costsTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Costs &amp; Benefits Analysis</h4>
        <div class="qaly-selector">
          <label for="qalySelect">Select QALY Gain per Life Saved:</label>
          <select id="qalySelect" onchange="renderCostsBenefits()">
            <option value="low">Low (5 QALYs per life)</option>
            <option value="moderate" selected>Moderate (10 QALYs per life)</option>
            <option value="high">High (20 QALYs per life)</option>
          </select>
        </div>
        <div id="costsBenefitsResults">
          <!-- Summary and combined chart will render here -->
        </div>
        <div class="modelling-assumptions">
  <h3><i class="fa-solid fa-lightbulb"></i> Modelling Assumptions</h3>
  <p>
    This analysis uses a fixed implementation cost of $200 000 per 100 000 population (for outreach, IT verification and enforcement) and a variable cost of $50 per person vaccinated (vaccine doses, administration and logistics). Health benefits are monetized at $50 000 per QALY gained, reflecting common willingness‐to‐pay thresholds in economic evaluations. For context, regulatory bodies often apply a Value of a Statistical Life around A$5-6 million, which corresponds to ~20 QALYs at A$250 000 each. Results vary with outbreak severity: mandates generate substantial net benefits in high‐risk (severe) scenarios but may be cost‐inefficient during mild or contained outbreaks.
  </p>
</div>
        <div class="cost-icons">
          <button class="buttons-row" onclick="toggleCostBreakdown()">Cost Breakdown</button>
          <button class="buttons-row" onclick="toggleBenefitsAnalysis()">Benefits Analysis</button>
        </div>
        <div id="detailedCostBreakdown" class="cost-cards" style="display: none;">
          <!-- Cost breakdown cards will be injected here by the script -->
        </div>
        <div id="detailedBenefitsAnalysis" class="cost-cards" style="display: none;">
          <div class="cost-card">
            <h4><i class="fa-solid fa-hand-holding-dollar"></i> QALY Benefits Calculation</h4>
            <p>Calculated as: (Lives Saved × QALYs per life) × Value per QALY. For example, if 10 lives are saved and each life equals 10 QALYs, at €50,000 per QALY the benefit is €5,000,000.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Saved Scenarios Tab -->
    <section id="scenariosTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Saved Scenarios</h4>
        <p>Each saved scenario appears as a row in the table, listing the inputs and outputs. You can compare outcomes across countries or policy configurations. Use the buttons below to add the current scenario to the list, or to export all scenarios in a PDF report.</p>
        <div class="buttons-row">
          <button onclick="saveScenario()">Save Current Scenario</button>
          <button onclick="openComparison()">Compare &amp; Export to PDF</button>
        </div>
        <div class="table-container">
          <table id="scenarioTable">
            <thead>
              <tr>
                <th>Name</th>
                <th>Country</th>
                <th>Scenario</th>
                <th>Lives Saved<br/>(per 100k)</th>
                <th>All Occ.?</th>
                <th>Med+Rel.?</th>
                <th>Broad?</th>
                <th>70%?</th>
                <th>90%?</th>
                <th>Uptake (%)</th>
                <th>Net Benefit</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="demoTab" class="tabcontent" tabindex="0">
  <div class="calculation-info">
    <h4>Video Demonstration</h4>
    <div class="video-container">
      <div style="padding:56.25% 0 0 0;position:relative;">
        <iframe src="https://player.vimeo.com/video/1107399340?badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479"
          frameborder="0" allow="autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media; web-share"
          referrerpolicy="strict-origin-when-cross-origin"
          style="position:absolute;top:0;left:0;width:100%;height:100%;"
          title="VaxMandate Decision Aid Tool - Optimise Vaccine Mandates">
        </iframe>
      </div>
      <script src="https://player.vimeo.com/api/player.js"></script>
    </div>
  </div>
</section>

    <footer>
      <p>&copy; 2025 Vaccine Mandate Policy Simulator. All Rights Reserved.<br />Mesfin Genie, Newcastle Business School, The University of Newcastle, Australia</p>
    </footer>
  </div>

  <script src="script.js"></script>
</body>
</html>
